<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>App de Imóveis - Mobile & Desktop</title>
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f4f6f8; margin:0; padding:0; }
#lista { display:grid; grid-template-columns:1fr; gap:16px; margin-bottom:30px; padding:0 10px; }
.card { border-radius:12px; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.1); transition:0.2s; display:flex; flex-direction:column; }
.card:hover { transform:translateY(-4px); box-shadow:0 8px 20px rgba(0,0,0,0.2); }
.card img { width:100%; height:180px; object-fit:cover; }
.card-body { padding:12px; flex:1; display:flex; flex-direction:column; justify-content:space-between; }
.card h3 { margin:0; font-size:16px; color:#1a1a1a; }
.card p { margin:4px 0; color:#555; font-size:13px; }
.card p.preco { font-weight:bold; color:#2d89ef; font-size:15px; }
.btn-detalhes, .btn-whatsapp { display:block; margin:10px auto 0; background:#25D366; color:#fff; text-align:center; padding:8px 20px; border-radius:6px; font-weight:bold; text-decoration:none; cursor:pointer; font-size:14px; }
.btn-whatsapp:hover { background:#1da851; }

.modal { display:none; position:fixed; z-index:9999; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.7); overflow:auto; }
.modal-content { background:#fff; padding:15px; border-radius:12px; width:95%; max-width:400px; max-height:90vh; overflow-y:auto; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); box-sizing:border-box; }
.close { color:#aaa; position:absolute; top:8px; right:15px; font-size:24px; font-weight:bold; cursor:pointer; }
.close:hover { color:#000; }

#whatsapp-flutuante { position:fixed; right:15px; width:50px; height:50px; z-index:9998; cursor:pointer; }
#whatsapp-flutuante img { width:100%; height:100%; border-radius:50%; }

#destaques-container { position:relative; margin:15px 0; }
#destaques { display:flex; gap:12px; overflow-x:auto; scroll-behavior:smooth; padding:0 40px; }
.destaque-card { min-width:160px; flex:0 0 auto; border-radius:12px; overflow:hidden; background:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.1); cursor:pointer; transition:0.2s; }
.destaque-card:hover { transform:translateY(-3px); box-shadow:0 6px 18px rgba(0,0,0,0.2); }
.destaque-card img { width:100%; height:100px; object-fit:cover; }
.destaque-card p { padding:6px; margin:0; font-size:12px; font-weight:bold; color:#2d89ef; text-align:center; }

.destaque-left, .destaque-right { position:absolute; top:50%; transform:translateY(-50%); font-size:28px; color:#fff; background:rgba(0,0,0,0.4); padding:6px 12px; border-radius:50%; cursor:pointer; z-index:10; }
.destaque-left { left:5px; } .destaque-right { right:5px; }

@media (min-width:600px) { #lista { grid-template-columns:repeat(2,1fr); } }
@media (min-width:900px) { #lista { grid-template-columns:repeat(3,1fr); } }
</style>
</head>
<body>

<div id="destaques-container">
  <span class="destaque-left">&#10094;</span>
  <div id="destaques"></div>
  <span class="destaque-right">&#10095;</span>
</div>

<div id="imoveis-app">
  <div id="lista"></div>

  <div id="detalhesModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>
</div>

<a href="https://api.whatsapp.com/send?phone=5512992468636" target="_blank" id="whatsapp-flutuante">
  <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="WhatsApp" />
</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
// WhatsApp flutuante
const whatsapp = document.getElementById('whatsapp-flutuante');
let targetY = window.innerHeight - 80, currentY = targetY;
function animate() { currentY += (targetY-currentY)*0.1; whatsapp.style.top = currentY + "px"; requestAnimationFrame(animate); }
animate();
document.addEventListener('mousemove', e => { targetY = e.clientY - 25; if(targetY<15) targetY=15; if(targetY>window.scrollY+window.innerHeight-65) targetY=window.scrollY+window.innerHeight-65; });
window.addEventListener('scroll', ()=>{ targetY = Math.min(targetY, window.scrollY + window.innerHeight - 65); });

// Modal
const modal = document.getElementById("detalhesModal");
const modalBody = document.getElementById("modal-body");
const closeBtn = modal.querySelector(".close");
function abrirModal(imovel){
  modalBody.innerHTML = `<h2>${imovel.titulo}</h2><p>R$ ${Number(imovel.preco).toLocaleString()}</p>`;
  modal.style.display="block"; whatsapp.style.display="none";
}
function fecharModal(){ modal.style.display="none"; whatsapp.style.display="block"; }
closeBtn.onclick = fecharModal;
window.onclick = e=>{ if(e.target===modal) fecharModal(); }

// Lista de imóveis
class ListaImoveis {
  constructor(id){ this.lista=document.getElementById(id); this.filteredData=[]; }
  render(dados){ this.lista.innerHTML=""; this.filteredData=dados; this.filteredData.forEach(i=>{
    const c=document.createElement("div"); c.className="card";
    c.innerHTML=`<img src="${i.imagens.split(" ")[0]||'https://via.placeholder.com/400x250'}"><div class="card-body"><h3>${i.titulo}</h3><p class="preco">R$ ${Number(i.preco).toLocaleString()}</p><button class="btn-detalhes">Detalhes</button></div>`;
    c.querySelector(".btn-detalhes").onclick=()=> abrirModal(i);
    this.lista.appendChild(c);
  }); }
}

// Carrossel de destaques
class Destaques{
  constructor(dados){
    const container = document.getElementById("destaques");
    const cardsHTML = dados.slice(0,10).map(i=>`<div class="destaque-card"><img src="${i.imagens.split(" ")[0]||'https://via.placeholder.com/200x120'}"><p>${i.titulo} - R$ ${Number(i.preco).toLocaleString()}</p></div>`).join('');
    container.innerHTML = cardsHTML;
    const allCards = container.querySelectorAll(".destaque-card");
    allCards.forEach((card, idx)=>card.onclick = ()=> abrirModal(dados[idx]));
    const cardWidth = container.querySelector(".destaque-card").offsetWidth + 12;
    const left = document.querySelector(".destaque-left");
    const right = document.querySelector(".destaque-right");
    const scrollByCard = (amount)=>{ container.scrollBy({ left: amount, behavior:'smooth' }); };
    left.onclick = ()=>scrollByCard(-cardWidth); right.onclick = ()=>scrollByCard(cardWidth);
    setInterval(()=>scrollByCard(cardWidth),4000);

    // Swipe
    let startX=0, dragging=false;
    container.addEventListener("touchstart",e=>{ startX = e.touches[0].clientX; dragging=true; });
    container.addEventListener("touchmove",e=>{ if(!dragging) return; const diff = startX - e.touches[0].clientX; if(Math.abs(diff)>30){ scrollByCard(diff>0?cardWidth:-cardWidth); startX=e.touches[0].clientX; }});
    container.addEventListener("touchend",()=>{ dragging=false; });
  }
}

// Carregar CSV
Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vQP-T1jc4Rpdigxqpkf7cL0MYiA8IESg1ATBwVdT7gTTPaMll_LGuwj0zOfbeEIO8Qv3DOZsK6eNBrZ/pub?gid=11391417&single=true&output=csv",{ download:true, header:true, complete: res=>{
  const dados = res.data.slice(1).map(i=>{ i.preco=i.preco||"0"; i.titulo=i.titulo||""; i.imagens=i.imagens||""; return i; });
  const lista = new ListaImoveis("lista");
  lista.render(dados);
  new Destaques(dados);
}});
</script>

</body>
</html>
