<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>App de ImÃ³veis - Premium</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<style>
body{font-family:'Segoe UI',sans-serif;background:#f4f6f8;margin:0;padding:0;}
#lista{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px;}
.card{border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.1);overflow:hidden;background:#fff;transition: transform 0.2s, box-shadow 0.2s, opacity 0.4s ease, transform 0.4s ease;display:flex;flex-direction:column;opacity:0;transform:translateY(20px);}
.card.show{opacity:1;transform:translateY(0);}
.card:hover{transform: translateY(-6px);box-shadow:0 12px 24px rgba(0,0,0,0.2);}
.card img{width:100%;height:180px;object-fit:cover;cursor:pointer;}
.card-body{padding:12px;flex:1;display:flex;flex-direction:column;justify-content:space-between;}
.card h3{margin:0;font-size:16px;color:#1a1a1a;}
.card p{margin:4px 0;color:#555;font-size:13px;}
.card p.preco{font-weight:bold;color:#2d89ef;font-size:15px;}
.modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;background-color: rgba(0,0,0,0.6);}
.modal-content{background:#fff;padding:20px;border-radius:12px;width:90%;max-width:500px;max-height:90vh;overflow-y:auto;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0.95);opacity:0;transition:opacity 0.3s, transform 0.3s;}
.modal-content.show{opacity:1;transform:translate(-50%,-50%) scale(1);}
.modal-content img{width:100%;max-height:300px;object-fit:cover;border-radius:8px;margin-bottom:10px;cursor:pointer;transition: transform 0.3s;}
.modal-content img.zoomed{transform: scale(2);cursor: move;}
.modal-content img:hover:not(.zoomed){transform: scale(1.05);}
.miniaturas{display:flex;justify-content:center;gap:8px;margin-top:10px;flex-wrap:wrap;}
.miniaturas img{width:60px;height:60px;object-fit:cover;border-radius:6px;cursor:pointer;border:2px solid transparent;transition:border 0.2s, transform 0.3s;}
.miniaturas img.selected{border-color:#2d89ef;transform:scale(1.05);}
.close{color:#aaa;position:absolute;top:10px;right:20px;font-size:28px;font-weight:bold;cursor:pointer;}
.close:hover{color:#000;}
#destaques-container{display:flex;align-items:center;position:relative;margin:20px 0;overflow:hidden;}
#destaques{display:flex;gap:16px;overflow-x:auto;scroll-behavior:smooth;flex:1;padding-bottom:10px;}
#destaques::-webkit-scrollbar{display:none;}
#destaques .destaque-card{min-width:200px;flex:0 0 auto;border-radius:12px;overflow:hidden;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.1);cursor:pointer;transition: transform 0.2s, box-shadow 0.2s, opacity 0.4s ease;opacity:0;}
#destaques .destaque-card.show{opacity:1;}
#destaques .destaque-card:hover{transform: translateY(-5px);box-shadow:0 8px 20px rgba(0,0,0,0.2);}
#destaques .destaque-card img{width:100%;height:120px;object-fit:cover;}
#destaques .destaque-card p{padding:8px;margin:0;font-size:14px;font-weight:bold;color:#2d89ef;text-align:center;}
.destaque-left,.destaque-right{position:absolute;top:50%;transform:translateY(-50%);font-size:36px;color:#fff;background:rgba(0,0,0,0.4);padding:6px 12px;border-radius:50%;cursor:pointer;user-select:none;z-index:10;}
.destaque-left{left:0;}
.destaque-right{right:0;}
.tab{display:inline-block;padding:8px 16px;cursor:pointer;border-radius:6px;background:#eee;margin-right:5px;font-weight:bold;}
.tab.active{background:#2d89ef;color:#fff;}
.ordenacao-select{padding:6px 10px;border-radius:6px;border:1px solid #ccc;font-size:14px;margin-right:10px;}
@media(max-width:768px){#lista{grid-template-columns:1fr;} .card img{height:150px;} .tab{overflow-x:auto; white-space:nowrap;}}

/* WhatsApp flutuante */
#whatsapp-flutuante {position:fixed;bottom:20px;right:20px;width:60px;height:60px;border-radius:50%;background:url('https://cdn-icons-png.flaticon.com/512/733/733585.png') no-repeat center center;background-size:cover;box-shadow:0 4px 12px rgba(0,0,0,0.3);cursor:pointer;z-index:9999;display:flex;align-items:center;justify-content:center;text-decoration:none;animation:pulse 2.5s infinite;transition:transform 0.2s;}
#whatsapp-flutuante:hover{transform:scale(1.1);animation:none;}
#whatsapp-flutuante .tooltip{position:absolute;right:100%;margin-right:15px;background:#25D366;color:#fff;padding:8px 12px;border-radius:20px;font-size:14px;font-weight:bold;white-space:nowrap;opacity:0;pointer-events:none;transform:translateX(10px);transition:opacity 0.3s,transform 0.3s;box-shadow:0 4px 10px rgba(0,0,0,0.2);}
#whatsapp-flutuante .tooltip::after{content:"";position:absolute;top:50%;left:100%;margin-top:-6px;border-width:6px;border-style:solid;border-color:transparent transparent transparent #25D366;}
#whatsapp-flutuante:hover .tooltip{opacity:1;transform:translateX(0);}
@keyframes pulse{0%{transform:scale(1);box-shadow:0 4px 12px rgba(0,0,0,0.3);}50%{transform:scale(1.08);box-shadow:0 6px 16px rgba(0,0,0,0.4);}100%{transform:scale(1);box-shadow:0 4px 12px rgba(0,0,0,0.3);}}
</style>
</head>
<body>

<div id="destaques-container">
  <span class="destaque-left">&#10094;</span>
  <div id="destaques"></div>
  <span class="destaque-right">&#10095;</span>
</div>

<div id="imoveis-app">
  <div id="tabs-container"></div>
  <div id="filtros-container"></div>
  <div id="ordenacao-container"></div>
  <div id="lista"></div>

  <div id="detalhesModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <img id="modal-main-img" src="" alt="Imagem do ImÃ³vel">
      <div class="miniaturas" id="modal-thumbnails"></div>
      <div id="modal-body"></div>
    </div>
  </div>
</div>

<a id="whatsapp-flutuante" href="https://api.whatsapp.com/send?phone=5512992468636" target="_blank">
  <span class="tooltip">ðŸ’¬ Fale conosco no WhatsApp</span>
</a>

<script>
// Tooltip WhatsApp
const whatsappBtn = document.getElementById('whatsapp-flutuante');
whatsappBtn.addEventListener('mouseenter',()=>{const t=whatsappBtn.querySelector('.tooltip');t.style.opacity='1';t.style.transform='translateX(0)';});
whatsappBtn.addEventListener('mouseleave',()=>{const t=whatsappBtn.querySelector('.tooltip');t.style.opacity='0';t.style.transform='translateX(10px)';});

// Destaques carrossel
const destaqueContainer = document.getElementById('destaques');
document.querySelector('.destaque-left').addEventListener('click',()=>destaqueContainer.scrollBy({left:-220,behavior:'smooth'}));
document.querySelector('.destaque-right').addEventListener('click',()=>destaqueContainer.scrollBy({left:220,behavior:'smooth'}));

// InicializaÃ§Ã£o PapaParse
Papa.parse("imoveis.csv",{download:true,header:true,skipEmptyLines:true,complete:res=>{
  const dadosRaw = res.data.slice(1);
  const dados = dadosRaw.map(i=>{
    i.ref=i.ref||"";i.pet=(i.pet&&["sim","s","1"].includes(i.pet.trim().toLowerCase()))?"Sim":"NÃ£o";
    i.condominio=(i.cond_incluso&&["sim","s","1"].includes(i.cond_incluso.trim().toLowerCase()))?"Sim":"NÃ£o";
    i.garagem=i.garagem||"0";i.titulo=i.titulo||"";i.descricao=i.descricao||"";i.tipo=i.tipo||"";
    i.operacao=i.operacao||"";i.cidade=i.cidade||"";i.preco=i.preco||"0";i.area=i.area||"0";i.banheiros=i.banheiros||"0";
    i.quartos=i.quartos||"0";i.imagens=i.imagens||"";return i;
  });

  // Modal, lista, filtros, tabs, destaques
  const modal = new ModalImovel("detalhesModal");
  const lista = new ListaImoveis("lista",modal);
  new FiltroImoveis("filtros-container",dados,lista);
  new TabsImoveis("tabs-container",dados,lista);
  new OrdenacaoImoveis("ordenacao-container",lista);
  new Destaques(dados);

  // Fade+slide para cards e destaques
  document.querySelectorAll('#lista .card').forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*100));
  document.querySelectorAll('#destaques .destaque-card').forEach((c,i)=>setTimeout(()=>c.classList.add('show'),i*100));
}});

// Modal fade+slide com miniaturas interativas
const modalEl = document.getElementById('detalhesModal');
const modalContent = modalEl.querySelector('.modal-content');
const modalMainImg = document.getElementById('modal-main-img');
const modalThumbs = document.getElementById('modal-thumbnails');

document.addEventListener('click',e=>{
  if(e.target.classList.contains('close')){
    modalContent.classList.remove('show');
    modalEl.style.display='none';
  }
});

// FunÃ§Ã£o para abrir modal com imagens
function abrirModal(imagens){
  modalThumbs.innerHTML='';
  modalMainImg.src=imagens[0];
  imagens.forEach(src=>{
    const img = document.createElement('img');
    img.src=src;
    img.classList.add('thumbnail');
    img.addEventListener('click',()=>modalMainImg.src=src);
    modalThumbs.appendChild(img);
  });
  modalEl.style.display='block';
  setTimeout(()=>modalContent.classList.add('show'),10);
}
</script>
</body>
</html>
